% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fitgam.r
\name{fitgam_perda}
\alias{fitgam_perda}
\title{Ajuste De Curva Para Perdas}
\usage{
fitgam_perda(
  dat,
  ns.vazao = 10,
  ts.vazao = "ps",
  extrap = c(2, 2),
  quantil = c(0.05, 0.95)
)
}
\arguments{
\item{dat}{\code{data.table} de dados para ajuste. Ver Detalhes}

\item{ns.vazao}{dimensão da base expandida para ajuste. Padrão 10}

\item{ts.vazao}{tipo de spline utilizada para vazão -- veja \code{\link[mgcv]{smooth.terms}} para
todas as opções. Padrão \code{"ps"}}

\item{extrap}{vetor de duas posições indicando o tipo de extrapolação em cada região. Ver
Detalhes. Padrao tipo 2 para ambas as extrapolações}

\item{quantil}{quantis para uso na extrapolação. Ver Detalhes}
}
\value{
objeto \code{gamperda} contendo modelo aditivo e extrapolações estimadas
}
\description{
Estima GAM para perdas, complementando regiões inferior e superior com extrapolação
}
\details{
\code{fitgam_perda} espera que alguns atributos especiais estejam presetnes no argumento
\code{dat}, dentre eles: codigo, nome e vazao turbinada efetiva total da usina. Destes, apenas
o último é relevante para a estimação de curva, sendo os outros dois necessários para escrita
de resultados e plots. Desta forma, para garantir o funcionamento apropriado da função o objeto
passado em \code{dat} deve ter sido lido e (possivelmente) agregado semanalmente pelas funções
fornecidas no pacote.

Para extrapolação, independentemente do tipo, duas partes do dado serão seccionadas:
correspondente às vazões inferiores a \code{quantil[1]} e outra àquelas superiores a
\code{quantil[2]}. Caso seja adotada extrapolação tipo 1:
\enumerate{
\item Para região inferior, uma equação do tipo \eqn{kQ^2} será ajustada entre a origem e o ponto de
de menor perda
\item Para região superior é feito o mesmo, porém para o ponto de maior vazão
}

Se for selecionada a extrapolação do tipo 2
\enumerate{
\item Ajusta-se uma curva \eqn{kQ^2} aos pontos da região inferior
\item Ajusta-se uma curva \eqn{a + kQ^2} aos pontos da região superior
}

Uma vez realizadas as extrapolações, o ajuste final é composto chaveando modelos no cruzamento
entre curvas. Caso não ocorra interseção, é utilizado o ponto de vazão no qual a distância entre
elas seja a menor possível e um aviso será emitido.

\code{ts.vazao} permite a especificação do tipo de spline utilizada na expansão de base. Todos os
tipos definidos em \code{\link[mgcv]{mgcv}} são suportados. Para maiores detalhes a respeito das
possibilidades e suas descrições, veja \code{\link[mgcv]{smooth.terms}}. Por padrão é utilizado
\code{ts.vazao = "ps"}, o que corresponde à expansão por P-Splines.
}
\examples{

dat <- agregasemana(dummydata)

# ajustes com diferentes tipos de splines (com 10 nÃ³s em todos os casos)
fit_tp <- fitgam_perda(dat, ns.vazao = 10, ts.vazao = "tp")
fit_cr <- fitgam_perda(dat, ns.vazao = 10, ts.vazao = "cr")
fit_ps <- fitgam_perda(dat, ns.vazao = 10, ts.vazao = "ps")

# valores ajustados, previsao e residuos
res <- residuals(fit_tp)
fitt <- fitted(fit_tp)
predd <- predict(fit_tp, newdata = data.frame(vazao = runif(100, 20, 150)))

# objetos retornados por fitgam_perda possuem um metodo de plot e lines, para facil visualizacao
\dontrun{
plot(fit_tp)
plot(fit_tp, fit_cr, fit_ps)
}

}
\seealso{
otimização da dimensão de base \code{\link{optgam_perda}}.

Other metodos gamperda: 
\code{\link{fitted.gamperda}()},
\code{\link{optgam_perda}()},
\code{\link{predict.gamperda}()},
\code{\link{residuals.gamperda}()}

Other plots gamperda: 
\code{\link{optgam_perda}()},
\code{\link{plot.gamperda}()}
}
\concept{metodos gamperda}
\concept{plots gamperda}
